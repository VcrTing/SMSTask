(window.webpackJsonp=window.webpackJsonp||[]).push([[146],{"./app/scripts/controller/memberHomePage.js":function(e,t,a){function s(e,t){return null!=e?t(e):void 0}const n=a("./packages/jquery/index.js"),{Auth:i}=a("./app/scripts/db/auth.js"),{l:r}=a("./app/scripts/lib/localize.js"),{TrelloStorage:o}=a("./packages/storage/index.ts"),{Apdex:l,Analytics:m,getScreenFromUrl:c}=a("./packages/atlassian-analytics/index.ts"),p=a("./app/scripts/lib/util/index.js"),{trackGTMEvent:d}=a("./packages/analytics/index.ts"),{isMemberOfOrg:g,getHomeLastTab:u,redirectHomeToDefaultTab:b,getHomeLastTabStorageKey:h}=a("./app/scripts/controller/memberPageHelpers.js"),{navigate:w}=a("./app/scripts/controller/navigate.js"),{importWithRetry:f}=a("./packages/use-lazy-component/index.ts");let y=!1,S=null,k=!1;n(window).on("popstate",(()=>k=!0));e.exports.memberHomePage=function(e={}){const{orgname:t,showHomeBoardsTab:v,showGettingStarted:H,templatesData:j,titleKey:M}=e,{ModelCache:T}=a("./app/scripts/db/model-cache.js");if(!i.isLoggedIn())return this.displayErrorPage();j&&"all"===j.category&&!j.shortLink&&w("/templates",{trigger:!0,replace:!0});const B=(()=>{switch(!1){case!v:return"memberBoards";default:return"memberHome"}})();return j||l.start({task:B}),T.waitFor("Member",i.myId(),(()=>f((()=>a.e(148).then(a.t.bind(null,"./app/scripts/controller/memberPage.js",7)))).then((({memberPage:e})=>{const f=p.idToDate(i.myId())>p.dateBefore({minutes:3}),x=s(i.me(),(e=>e.isDismissed("sent-possible-new-signup-event")));(S||!x&&f)&&(d({event:"trello.possibleNewSignup",ed:s(i.me(),(e=>e.getEmailDomain()))}),s(i.me(),(e=>e.dismiss("sent-possible-new-signup-event"))));const D=u.call(this);if(!(t||v||H||j||!D||"/"===D||k))return k=!1,l.cancel({task:B}),y=l.isInitialLoad&&l.initialUrl===window.location.href,w(D,{trigger:!0,replace:!0});if(k&&o.set(h(),window.location.pathname),t&&!g(t))return b.call(this);!function(e,t,n,i){var r;const{ModelCache:o}=a("./app/scripts/db/model-cache.js");let l="",p={};if(e&&t&&!n)l="organizationBoardsHomeScreen",p={teamId:s(o.findOne("Organization","name",e),(e=>e.id))};else if(e||!t||n||i)if(e||t||!n||i)if(e||t||n||i){if(!i||e||t||n)return;l="organizationGettingStartedScreen"}else l="memberHomeScreen";else l="templateGalleryScreen";else l="memberBoardsHomeScreen";m.sendOperationalEvent({action:"rendered",actionSubject:l,source:c(),containers:{organization:{id:null===(r=p)||void 0===r?void 0:r.teamId}}})}(t,v,j,H),k=!1,null==S&&(S=n.cookie("simulateNewUser"));const z={username:"me",loadFn:t||v||!j?"loadMemberBoardsData":"loadMinimumMemberDataForTemplatePage",viewClassName:"MemberHomeView",getLocation:e=>this.getMemberBoardsUrl(e,t,v,j,H),titleKey:M||"boards",orgname:t,showHomeBoardsTab:v,showGettingStarted:H,templatesData:j};return e.call(this,z).then((()=>{const e=void 0===t?r(["page title","home"]):!t&&v?r(["page title","boards"]):s(T.findOne("Organization","name",t),(e=>e.get("displayName")));return this.title(e)})).tap((function(){if("memberBoards"===B)return y&&l.resetInitialState(),l.stop({task:B}),y=!1})).done()}))))}}}]);
//# sourceMappingURL=member-home-page.4ddd589ddbc5a87494e2.js.map